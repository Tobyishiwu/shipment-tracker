<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Live Tracking Portal | GID Logistics</title>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root { --gid-red: #e31e24; --navy: #0f172a; }
        body { font-family: 'Plus Jakarta Sans', sans-serif; background: #f1f5f9; margin: 0; padding: 60px 20px; color: var(--navy); }
        .container { max-width: 600px; margin: 0 auto; }
        .card { background: white; padding: 45px; border-radius: 28px; box-shadow: 0 15px 50px rgba(0,0,0,0.08); border: 1px solid rgba(0,0,0,0.03); position: relative; }
        .secure-badge { position: absolute; top: 20px; right: 20px; background: #f0fdf4; color: #16a34a; padding: 5px 12px; border-radius: 20px; font-size: 10px; font-weight: 800; text-transform: uppercase; letter-spacing: 1px; }
        .status-hero { text-align: center; margin-bottom: 50px; }
        .status-hero h1 { font-size: 2.8rem; margin: 10px 0; font-weight: 800; letter-spacing: -1px; }
        .status-hero small { font-weight: 800; color: #94a3b8; text-transform: uppercase; letter-spacing: 2px; }
        .stepper { display: flex; justify-content: space-between; position: relative; margin: 50px 0; }
        .line-bg { position: absolute; top: 12px; left: 10%; right: 10%; height: 5px; background: #e2e8f0; z-index: 1; border-radius: 10px; }
        .line-fill { position: absolute; top: 12px; left: 10%; width: 0%; height: 5px; background: var(--gid-red); z-index: 2; transition: 1.8s cubic-bezier(0.4, 0, 0.2, 1); border-radius: 10px; }
        .step { position: relative; z-index: 3; text-align: center; width: 20%; }
        .dot { width: 24px; height: 24px; background: white; border: 5px solid #e2e8f0; border-radius: 50%; margin: 0 auto; transition: 0.5s; }
        .step.active .dot { border-color: var(--gid-red); background: var(--gid-red); box-shadow: 0 0 15px rgba(227, 30, 36, 0.4); }
        .step label { display: block; margin-top: 15px; font-size: 11px; font-weight: 800; text-transform: uppercase; color: #94a3b8; }
        .step.active label { color: var(--navy); }
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; border-top: 2px solid #f8fafc; padding-top: 35px; }
        .info-box { background: #f8fafc; padding: 22px; border-radius: 18px; border: 1px solid #eef2f6; }
        .info-box label { font-size: 11px; font-weight: 800; color: #64748b; text-transform: uppercase; display: block; margin-bottom: 8px; }
        .info-box div { font-weight: 700; font-size: 1.1rem; }
        .btn-receipt { display: none; width: 100%; background: var(--navy); color: white; border: none; padding: 22px; border-radius: 16px; font-weight: 800; margin-top: 35px; cursor: pointer; font-size: 1.1rem; transition: 0.3s; }
        .loader { text-align: center; padding: 80px; font-weight: 800; font-size: 1.2rem; }
        .chat-widget { position: fixed; bottom: 30px; right: 30px; z-index: 1000; background: #25d366; color: white; width: 60px; height: 60px; border-radius: 50%; display: flex; align-items: center; justify-content: center; text-decoration: none; box-shadow: 0 10px 25px rgba(37, 211, 102, 0.4); }
    </style>
</head>
<body>
<div class="container">
    <div id="loading" class="loader">üîê Synchronizing with GID Cloud...</div>
    <div id="results" style="display:none;">
        <div class="card">
            <div class="secure-badge">‚úì Secure Link</div>
            <div class="status-hero"><small id="wbDisplay">---</small><h1 id="stText">Processing</h1></div>
            <div class="stepper">
                <div class="line-bg"></div><div class="line-fill" id="fillBar"></div>
                <div class="step" id="s1"><div class="dot"></div><label>Created</label></div>
                <div class="step" id="s2"><div class="dot"></div><label>Picked</label></div>
                <div class="step" id="s3"><div class="dot"></div><label>Transit</label></div>
                <div class="step" id="s4"><div class="dot"></div><label>Out</label></div>
                <div class="step" id="s5"><div class="dot"></div><label>Delivered</label></div>
            </div>
            <div class="grid">
                <div class="info-box"><label>Destination</label><div id="lcText">---</div></div>
                <div class="info-box"><label>Last Update</label><div id="tmText">---</div></div>
            </div>
            <button class="btn-receipt" id="receiptBtn">Generate Official Receipt</button>
        </div>
    </div>
</div>
<a id="chatLink" href="https://wa.me/2347066958826" class="chat-widget" target="_blank">
    <svg viewBox="0 0 24 24" style="width:32px; height:32px; fill:white;"><path d="M12.031 6.172c-3.181 0-5.767 2.586-5.768 5.766-.001 1.298.38 2.27 1.019 3.287l-.582 2.128 2.182-.573c.978.58 1.911.928 3.145.929 3.178 0 5.767-2.587 5.768-5.766 0-3.18-2.587-5.771-5.764-5.771zm3.392 8.244c-.144.405-.837.774-1.17.824-.299.045-.677.063-1.092-.069-.252-.08-.575-.187-.988-.365-1.739-.751-2.874-2.502-2.961-2.617-.087-.116-.708-.94-.708-1.793s.448-1.273.607-1.446c.159-.173.346-.217.462-.217s.231.006.332.013c.101.007.237-.038.371.29s.462 1.128.502 1.209c.039.081.066.174.011.282-.055.108-.083.174-.166.27-.083.097-.167.177-.247.273-.081.096-.164.2-.07.362.094.161.411.679.883 1.101.607.541 1.117.708 1.282.79s.259.061.356-.049c.098-.11.411-.479.522-.642.11-.164.221-.137.371-.083.15.054.95.448 1.113.53s.271.136.311.204c.04.068.04.394-.104.799z"></path></svg>
</a>
<script>
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxCSYD4qFpSqMYtHlZdPzCDveU2AVXhaiQUQ00lbibiVPw56nlb8j_383SEO0zMtqTR/exec";
    window.onload = function() {
        const urlParams = new URLSearchParams(window.location.search);
        const trk = urlParams.get('id');
        if(!trk) return document.getElementById('loading').innerText = "Waybill ID Required.";
        const chatLink = document.getElementById('chatLink');
        chatLink.href = `https://wa.me/2347066958826?text=Hi GID Support, I need help with tracking number ${trk.toUpperCase()}.`;
        const script = document.createElement('script');
        script.src = `${SCRIPT_URL}?tracking=${trk.toUpperCase()}&callback=handleResults`;
        document.body.appendChild(script);
    };
    function handleResults(data) {
        if(data.error) { document.getElementById('loading').innerText = "ID Not Found."; return; }
        document.getElementById('loading').style.display = "none";
        document.getElementById('results').style.display = "block";
        document.getElementById('stText').innerText = data.status;
        document.getElementById('wbDisplay').innerText = data.tracking;
        document.getElementById('lcText').innerText = data.destination || "Registered";
        document.getElementById('tmText').innerText = data.lastUpdated || "Just now";
        const s = data.status.toLowerCase();
        let p = 0, n = 0;
        if(s.includes("delivered") || s.includes("arrived")){ p=80; n=5; }
        else if(s.includes("out")){ p=60; n=4; }
        else if(s.includes("transit")){ p=40; n=3; }
        else if(s.includes("picked")){ p=20; n=2; }
        else { p=5; n=1; }
        setTimeout(() => {
            document.getElementById('fillBar').style.width = p + "%";
            for(let i=1; i<=5; i++) { document.getElementById('s'+i).classList.toggle('active', i<=n); }
        }, 300);
        if(n === 5) {
            const btn = document.getElementById('receiptBtn');
            btn.style.display = "block";
            btn.onclick = () => window.open(`${SCRIPT_URL}?tracking=${data.tracking}&mode=receipt`, "_blank");
        }
    }
</script>
</body>
</html>
