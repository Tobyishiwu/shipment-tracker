<script>
  const API_URL = "https://script.google.com/macros/s/AKfycbxohtbQSeQxxyhqlyN6-5CSW7cr-201E53NVHaf-lGQDDaZLdaDH-DMM90i6DgJloKdwQ/exec";

  document.addEventListener("DOMContentLoaded", () => {
    const input = document.getElementById("trackingInput");
    const result = document.getElementById("result");
    const params = new URLSearchParams(window.location.search);
    const trackingParam = params.get("tracking");

    if (trackingParam) {
      input.value = trackingParam;
      track(trackingParam);
    }

    document.querySelector("button").addEventListener("click", () => {
      const tracking = input.value.trim();
      if (!tracking) {
        result.innerHTML = "<p class='error'>Enter a tracking number</p>";
        return;
      }
      track(tracking);
    });

    function track(tracking) {
      result.innerHTML = "Checking status...";

      fetch(API_URL + "?tracking=" + encodeURIComponent(tracking))
        .then(res => res.json())
        .then(data => {
          if (data.error) {
            result.innerHTML = "<p class='error'>" + data.error + "</p>";
            return;
          }

          result.innerHTML = `
            <div class="card">
              <p><strong>Status:</strong> ${data.status}</p>
              <p><strong>Current Location:</strong> ${data.currentLocation}</p>
              <p><strong>Last Updated:</strong> ${new Date(data.lastUpdated).toLocaleString()}</p>
            </div>
          `;
        })
        .catch(err => {
          console.error("Fetch error:", err);
          result.innerHTML = "<p class='error'>Unable to fetch tracking info</p>";
        });
    }
  });
</script>
