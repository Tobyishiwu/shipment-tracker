<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>GID Logistics | Command Centre</title>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root{--navy:#0f172a;--red:#e31e24;--bg:#f4f6f8;--muted:#64748b;--b:#e5e7eb}
        *{box-sizing:border-box}
        body{margin:0;font-family:'Plus Jakarta Sans',sans-serif;background:var(--bg);color:var(--navy);line-height:1.6}
        .wrap{max-width:1200px;margin:auto;padding:0 20px}
        header{background:#fff; border-bottom:1px solid var(--b); padding:18px 0; position: sticky; top:0; z-index: 100}
        .logo{font-size:22px;font-weight:800}.logo span{color:var(--red)}
        .hero{background:var(--navy);color:#fff;text-align:center;padding:80px 20px 120px}
        .hub{max-width:800px;margin:-80px auto 60px}
        .tabs{display:flex;gap:5px}.tab{padding:15px 30px; border:none; border-radius:8px 8px 0 0; cursor:pointer; font-weight:700; background:rgba(255,255,255,0.2); color:#fff; transition: 0.3s}
        .tab.active{background:#fff; color:var(--navy)}
        .card{background:#fff;padding:40px;border-radius:0 12px 12px 12px;box-shadow:0 20px 40px rgba(0,0,0,0.1)}
        .row{display:flex;gap:15px;margin-bottom:15px}
        input{flex:1;padding:14px;border:1.8px solid var(--b);border-radius:6px;font-size:16px; outline: none; transition: 0.2s}
        input:focus{border-color: var(--red)}
        button{background:var(--red);color:#fff;border:none;padding:16px;border-radius:6px;font-weight:800;cursor:pointer;width:100%; transition: 0.3s}
        button:hover{filter: brightness(1.1)}
        button:disabled{background: var(--muted); cursor: not-allowed}
        .service-toggle{display:flex;gap:10px;margin-bottom:20px}
        .s-opt{flex:1;padding:15px;border:2px solid var(--b);border-radius:8px;text-align:center;cursor:pointer;font-weight:700; transition: 0.3s}
        .s-opt.active{border-color:var(--red);background:#fff5f5;color:var(--red)}
        .hidden{display:none}
        #quote-res{margin-top:20px; padding:25px; background:#f0fdf4; border:1px solid #bbf7d0; border-radius:12px; display:none; text-align:center}
        #track-details{margin-top:20px; padding:20px; border:1px solid var(--b); border-radius:8px; background: #fafafa}
    </style>
</head>
<body>

<header>
    <div class="wrap" style="display:flex;justify-content:space-between;align-items:center">
        <div class="logo">GID<span>LOGISTICS</span></div>
        <div style="font-size:12px; font-weight:700; color:var(--muted)">v8.2 STABLE</div>
    </div>
</header>

<section class="hero">
    <h1>Logistics Command Centre</h1>
    <p>Secure waybill tracking and instant freight cost estimation.</p>
</section>

<section class="hub">
    <div class="tabs">
        <button id="t-track" class="tab active" onclick="show('track')">Track Shipment</button>
        <button id="t-quote" class="tab" onclick="show('quote')">Request Quote</button>
    </div>
    <div class="card">
        <div id="track">
            <h3>Track Your Shipment</h3>
            <div class="row">
                <input id="tid" placeholder="Enter Waybill ID (e.g. GID-1001)">
                <button onclick="runTrack()" style="width:140px" id="btn-t">Track</button>
            </div>
            <div id="track-details" class="hidden">
                <div style="display:grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                    <div><small style="color:var(--muted)">STATUS</small><br><strong id="r-status" style="color:var(--red)"></strong></div>
                    <div><small style="color:var(--muted)">DESTINATION</small><br><strong id="r-dest"></strong></div>
                    <div><small style="color:var(--muted)">WEIGHT</small><br><strong id="r-weight"></strong></div>
                    <div><small style="color:var(--muted)">LAST UPDATE</small><br><strong id="r-date"></strong></div>
                </div>
            </div>
        </div>

        <div id="quote" class="hidden">
            <h3>Freight Calculator</h3>
            <div class="service-toggle">
                <div class="s-opt active" id="s-air" onclick="setService('Air')">‚úàÔ∏è Air Freight</div>
                <div class="s-opt" id="s-sea" onclick="setService('Sea')">üö¢ Ocean Freight</div>
            </div>
            <div class="row">
                <input id="qN" placeholder="Full Name">
                <input id="qW" type="number" placeholder="Weight (kg)">
            </div>
            <div class="row">
                <input id="qF" placeholder="Origin City">
                <input id="qT" placeholder="Destination City">
            </div>
            <button onclick="runQuote()" id="btn-q">Get Instant Estimate</button>
            <div id="quote-res">
                <small style="text-transform:uppercase; letter-spacing:1px; font-weight:800; color:#16a34a">Estimated Total</small>
                <h2 id="final-price" style="margin:10px 0; font-size:32px; color:#065f46">$0.00</h2>
                <p style="font-size:13px; margin:0; color:#065f46">Submission successful. An admin has been notified.</p>
            </div>
        </div>
    </div>
</section>

<script>
// UPDATED TO YOUR LATEST DEPLOYMENT URL
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbzGB4VPw-K5x9NrLKBWY0LPCBdf4Xu3fR-4UuhThbqRvjVQ08XbAgDdXA8Hq44DvvoI/exec";
let selectedService = "Air";

function show(id){
    document.getElementById('track').classList.toggle('hidden', id !== 'track');
    document.getElementById('quote').classList.toggle('hidden', id !== 'quote');
    document.getElementById('t-track').classList.toggle('active', id === 'track');
    document.getElementById('t-quote').classList.toggle('active', id === 'quote');
    // Hide results when switching
    if(id === 'quote') document.getElementById('quote-res').style.display = 'none';
    if(id === 'track') document.getElementById('track-details').classList.add('hidden');
}

function setService(s){
    selectedService = s;
    document.getElementById('s-air').classList.toggle('active', s === 'Air');
    document.getElementById('s-sea').classList.toggle('active', s === 'Sea');
}

// JSONP HANDLERS
function handleTrack(r){
    document.getElementById('btn-t').innerText = "Track";
    document.getElementById('btn-t').disabled = false;
    if(r.error) {
        alert("Error: " + r.error);
        document.getElementById('track-details').classList.add('hidden');
        return;
    }
    document.getElementById('track-details').classList.remove('hidden');
    document.getElementById('r-status').innerText = r.status.toUpperCase();
    document.getElementById('r-dest').innerText = r.destination;
    document.getElementById('r-weight').innerText = r.weight;
    document.getElementById('r-date').innerText = r.updated;
}

function handleQuote(r){
    document.getElementById('btn-q').innerText = "Get Instant Estimate";
    document.getElementById('btn-q').disabled = false;
    if(r.status === "Success"){
        document.getElementById('quote-res').style.display = 'block';
        document.getElementById('final-price').innerText = r.cost;
        document.getElementById('quote-res').scrollIntoView({behavior: 'smooth'});
    } else {
        alert("System error. Please contact support.");
    }
}

function runTrack(){
    const id = document.getElementById('tid').value.trim();
    if(!id) return alert("Please enter a waybill ID");
    document.getElementById('btn-t').innerText = "Searching...";
    document.getElementById('btn-t').disabled = true;
    
    const s = document.createElement('script');
    s.src = `${SCRIPT_URL}?tracking=${encodeURIComponent(id)}&callback=handleTrack`;
    document.body.appendChild(s);
}

function runQuote(){
    const n = document.getElementById('qN').value, w = document.getElementById('qW').value;
    const f = document.getElementById('qF').value, t = document.getElementById('qT').value;
    if(!n || !w || !f || !t) return alert("All fields are required.");
    
    document.getElementById('btn-q').innerText = "Calculating...";
    document.getElementById('btn-q').disabled = true;
    
    const s = document.createElement('script');
    s.src = `${SCRIPT_URL}?action=saveQuote&name=${encodeURIComponent(n)}&weight=${w}&origin=${encodeURIComponent(f)}&destination=${encodeURIComponent(t)}&service=${selectedService}&callback=handleQuote`;
    document.body.appendChild(s);
}
</script>
</body>
</html>
