<div class="result" id="result">
  <div class="res-head">
    <strong id="status">â€”</strong>
    <span class="badge">LIVE</span>
  </div>
  
  <div id="shipment-details" style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; padding: 20px; border-bottom: 1px solid var(--b); font-size: 13px;">
    <div>
      <span style="color: var(--muted); display: block; text-transform: uppercase; font-size: 10px; font-weight: 800;">Destination</span>
      <strong id="res-dest">---</strong>
    </div>
    <div>
      <span style="color: var(--muted); display: block; text-transform: uppercase; font-size: 10px; font-weight: 800;">Weight</span>
      <strong id="res-weight">---</strong>
    </div>
    <div style="grid-column: span 2;">
      <span style="color: var(--muted); display: block; text-transform: uppercase; font-size: 10px; font-weight: 800;">Last Update</span>
      <strong id="res-date">---</strong>
    </div>
  </div>

  <div class="timeline">
    <div class="step" id="step1">Ordered</div>
    <div class="step" id="step2">Picked Up</div>
    <div class="step" id="step3">In Transit</div>
    <div class="step" id="step4">Delivered</div>
  </div>
</div>

<script>
function handleTrack(r){
  const btn = document.getElementById('trackBtn');
  btn.innerText = "Track";
  btn.disabled = false;

  if(r.error){
    alert("Waybill not found.");
    document.getElementById('result').style.display = 'none';
    return;
  }

  // 1. Show the box and set main status
  document.getElementById('result').style.display='block';
  document.getElementById('status').innerText = r.status.toUpperCase();
  
  // 2. Map the new data from your Google Sheet
  document.getElementById('res-dest').innerText = r.destination || "TBD";
  document.getElementById('res-weight').innerText = r.weight || "N/A";
  document.getElementById('res-date').innerText = r.updated || "Recently";

  // 3. Update Timeline (Logic remains the same)
  const steps = [document.getElementById('step1'), document.getElementById('step2'), document.getElementById('step3'), document.getElementById('step4')];
  steps.forEach(s => {s.classList.remove('active'); s.classList.remove('completed');});
  const st = r.status.toLowerCase();
  steps[0].classList.add('active');
  if(st.includes("picked") || st.includes("transit") || st.includes("delivered")) { steps[0].classList.add('completed'); steps[1].classList.add('active'); }
  if(st.includes("transit") || st.includes("delivered")) { steps[1].classList.add('completed'); steps[2].classList.add('active'); }
  if(st.includes("delivered")) { steps[2].classList.add('completed'); steps[3].classList.add('active'); }
}
</script>
